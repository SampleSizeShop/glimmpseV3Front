# ##############################################################################################################
# docker repo username
# ##############################################################################################################
REPO=${ECR_REPO}
# #############################################################################################################
# image name
# #############################################################################################################
IMAGE=${ECR_IMG}
# #############################################################################################################
# version
# #############################################################################################################
VERSION=$(node -e "console.log(require('./package.json').version)")
# #############################################################################################################
# build image
# #############################################################################################################
echo BUILDING IMAGE IN SCRIPT
docker build -t $REPO/$IMAGE:latest -t $REPO/$IMAGE:$VERSION .
# #############################################################################################################
# upload the image to AWS ECR repo
# #############################################################################################################
echo PUSH IMAGE IN SCRIPT
docker push $REPO/$IMAGE:latest
docker push $REPO/$IMAGE:$VERSION
