<h6>Hit Calculate to calculate stuff!! :)</h6>
<br>
<button (click)="postModel()" class="btn btn-primary btn-lg btn-block" id="calculate">Calculate!</button>
<div *ngIf="hasResults">
  <br>
  <button (click)="downloadResult()" class="btn btn-sm">Download result</button>
  <a id="downloadCsv" [attr.href]="downloadData" download="result.csv" hidden>Download result</a>
  <br>
  <br>
  <div class="table-responsive">
    <table class="table">
      <tr>
        <th>Power</th>
        <th>Total Sample Size</th>
        <th *ngIf="isSamplesize()">Target Power</th>
        <th>Means Scale Factor</th>
        <th>Variability Scale Factor</th>
        <th>Test</th>
        <th>Type I Error Rate</th>
      </tr>
      <tr *ngFor="let result of resultForDisplay; index as i"
          (click)="showDetail(getOutput(result), i, result.model.total_n)"
          [class] = "rowStyle(i)"
          [attr.id]="'result_display_row_'+i">
        <td *ngIf="!error(result)" id="{{'power_' + i}}">{{result.power}}</td>
        <td *ngIf="error(result)" id="{{'power_' + i}}">{{result.power}} {{result.model.errors}}</td>
        <td *ngIf="isSamplesize() && !error(result)">{{result.samplesize}}</td>
        <td *ngIf="isSamplesize() && error(result)">{{result.model.errors}}</td>
        <td *ngIf="isPower()">{{result.model.total_n}}</td>
        <td *ngIf="isSamplesize()" id="{{'targetpower_' + i}}">{{result.model.target_power}}</td>
        <td id="{{'means_scale_factor_' + i}}">{{ result.model.means_scale_factor }}</td>
        <td id="{{'variance_scale_factor_' + i}}">{{ result.model.variance_scale_factor }}</td>
        <td id="{{'test_' + i}}">{{ result.model.test }}</td>
        <td>{{ result.model.alpha }}</td>
      </tr>
    </table>
  </div>
  <div *ngIf="isShowDetail">
    <h4>Details</h4>
    <div class="form-group">
      <label>Power</label>
      <label class="form-control ng-binding">{{ detailPower }}</label>
    </div>
    <div class="form-group">
      <label>Independent Sampling Unit</label>
      <div class="well white-box">
        <ng-container *ngIf="detailCluster; else noClusterContent">
          <label class="ng-binding">{{ detailClusterLevels[0]['levelName'] }}</label>
          <ul *ngIf="detailClusterLevels.length > 0">
            <li *ngFor="let line of detailClusterOverview" class="ng-binding">{{ line }}</li>
          </ul>
        </ng-container>
        <ng-template #noClusterContent>
          <label class="ng-binding">participant</label>
        </ng-template>
      </div>
    </div>
    <div class="form-group">
      <label>Sample Size Details</label>
      <div class="table-responsive">
        <table class="table">
          <ng-container *ngIf="detailPredictor.length > 0; else noPredictorContent">
            <tr>
              <th *ngFor="let predictorObject of detailPredictor; index as i" [attr.id]="'predictor_'+i">{{predictorObject['name']}}</th>
              <th> {{ " Per Group Sample Size (" + detailClusterName + ")" }} </th>
            </tr>
            <tr *ngFor="let combination of detailPredictorCombination; index as i">
              <td *ngFor="let groupName of combination; index as j" [attr.id]="'group_'+i+'_'+j"> {{groupName}}</td>
              <td [attr.id]="'per_group_sample_size_'+i"> {{ smallestGroupSize * combinationsValueMap[combination.join('@')] }} </td>
            </tr>
            <tr>
              <td [attr.colspan]="detailPredictor.length"> Total Sample Size </td>
              <td id="totalsamplesize"> {{ detailSampleSize }} </td>
            </tr>
          </ng-container>
          <ng-template #noPredictorContent>
            <tr>
              <td>
                Total Sample Size: {{ detailSampleSize }}
              </td>
            </tr>
          </ng-template>
        </table>
      </div>
    </div>
  </div>
  <div id="results" [hidden]="!e2eTest">{{resultString | json}}</div>
</div>
<div id="reviewDataModel" [hidden]="!e2eTest">{{outputString}}</div>
<ng-template #helpText>
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Calculate Help</h5> <button type="button" class="close" (click)="dismissHelp()">
      <span aria-hidden="true">Ã—</span>
    </button>
    </div>
    <div class="modal-body">
      <p>Help text goes here</p>
    </div>
    <div class="modal-footer"> footer text</div>
  </div>
</ng-template>
