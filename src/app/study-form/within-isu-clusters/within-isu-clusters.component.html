<div *ngIf="isInfo()" id="firstcluster">
  <div class="container-fluid">
    <div class="row">
      <div class="row">
        <h6>Are your outcomes measured in a cluster?</h6>
      </div>
      <div class="row">
        <p>
          In a clustered design, the independent sampling unit is a cluster, such as a community, school, or classroom. Observations within a cluster are correlated. The labels for observations within a cluster must be exchangeable. For example, child "id" within classroom can be reassigned arbitrarily. In contrast, observations across time cannot be reassigned and should not be considered clustered observations. Clustering, or repeated measures, or a combination, creates a multilevel design. The common correlation between any pair of cluster members is termed the intraclass correlation or intracluster correlation. <br /><br />

          To include clustering in the study, click "Add Clustering" and follow the prompts. <br /><br />

          You may specify up to 3 levels of clustering. <br /><br />
        </p>
      </div>
      <div class="row" *ngIf="!hasCluster()">
        <div class="btn-group" data-toggle="buttons">
          <label id="includeclusterbtn" class="btn btn-primary">
            <input type="radio" id="includeclusterradio" (click)="includeClusters()">Define Clustering
          </label>
        </div>
      </div>
      <div class="row" *ngIf="hasCluster()">
        <div class="btn-group" data-toggle="buttons">
          <label id="editclusterbtn" class="btn btn-primary">
            <input type="radio" id="editclusterradio" (click)="includeClusters()">Edit Clustering
          </label>
        </div>
      </div>
    </div>
  </div>
</div>


  <div *ngIf="isElementName()">
    <div id="clustersheader">
      <h6>What term would you like to use for a participant in the study? (For example, student.)</h6>
    </div>
    <form [formGroup]="elementForm">
      <div class="form-group">
        <input class="form-control" formControlName="name" id="name" required>
        <div *ngIf="formErrors.cluster" class="form-group has-danger">
          <div class="form-control-feedback" id="nameerr">{{formErrors.cluster}}</div>
        </div>
      </div>name
    </form>
    <button class="btn btn-secondary btn-sm" (click)="setStage(stages.INFO)" id="namecancelbtn">Cancel</button>
    <button class="btn btn-secondary btn-sm" (click)="setStage(stages.INFO)" id="namebackbtn">Back</button>
    <button class="btn btn-primary btn-sm" (click)="setStage(stages.LEVELS)"   id="namenextbtn" [disabled]="!this.elementForm.valid">Next: Levels</button>
  </div>

  <div *ngIf="isLevels()">
    <h6>Name each level in the cluster and the number of elements in that level:</h6>
    <form [formGroup]="clusterLevelForm" id="clusterLevelForm">
      <div class="container-fluid">
        <div class="row">
          <div class="col col-md-auto">
            <div class="form-group">
              <label for="levelName">Clustering level name:</label>
              <input class="form-control" formControlName="levelName" id="levelName" required>
              <div *ngIf="formErrors.clusterlevelname" class="form-group has-danger">
                <div class="form-control-feedback" id="levelnameerr">{{formErrors.clusterlevelname}}</div>
              </div>
            </div>
          </div>
          <div class="col col-md-auto">
            <div class="form-group">
              <label for="noElements">Number of element:</label>
              <input class="form-control" formControlName="noElements" type="number" id="noElements" required>
              <div *ngIf="formErrors.elementnumber" class="form-group has-danger">
                <div class="form-control-feedback" id="noelementserr">{{formErrors.elementnumber}}</div>
              </div>
              <small id="noElementsHelp" class="form-text text-muted"># Elements must be an integer between 2 and 10000 (inclusive)</small>
            </div>
          </div>
          <div class="col col-md-auto">
            <br>
            <i class="material-icons" (click)="addLevel()" style="margin-top: 10px" id="addLevel">add</i>
          </div>
        </div>
      </div>
    </form>

    <br>
    <small>Levels:</small>
    <div *ngFor="let level of levels; let i = index">
      {{levels[i] | json}}
    </div>
    <div *ngIf="formErrors.clusterlevelrequired" class="form-group has-danger">
      <div class="form-control-feedback">{{formErrors.clusterlevelrequired}}</div>
    </div>
    <button class="btn btn-secondary btn-sm" (click)="setStage(stages.INFO)" id="levelscancelbtn">Cancel</button>
    <button class="btn btn-secondary btn-sm" (click)="setStage(stages.ELEMENT_NAME)" id="levelsbackbtn">Back</button>
    <button class="btn btn-primary btn-sm" (click)="addCluster()" id="levelsnextbtn" [disabled]="!validLevels">Finish</button>
  </div>

<br>

<div *ngIf="hasCluster() && isInfo()" >
  <small >Cluster:</small>
  <div class="container-fluid">
    <div class="row">
      <div class="col col-md-auto">
        <i class="material-icons" (click)="removeCluster(cluster)" style="margin-bottom: 5px" id="removecluster">remove</i>
      </div>
      <div class="col  col-md-auto">
        <i class="material-icons" (click)="editCluster(cluster)" style="margin-bottom: 5px" id="editcluster">create</i>
      </div>
      <div class="col">
        {{cluster | json}}
      </div>
    </div>
  </div>
</div>
